<view class="container">
  <!-- 顶部搜索栏和登录区域 -->
  <view class="top-bar">
    <view class="search-bar">
      <t-search
        value="{{searchValue}}"
        placeholder="搜索商品"
        shape="round"
        bind:change="onSearchChange"
        bind:submit="onSearchSubmit"
      ></t-search>
    </view>
    
    <!-- 用户登录/信息区域 -->
    <view class="user-area">
      <block wx:if="{{isLoggedIn}}">
        <view class="user-info" bindtap="navigateToMy">
          <image class="avatar" src="{{userInfo.avatarUrl || '/assets/icons/default_avatar.png'}}"></image>
          <text class="nickname">{{userInfo.nickName}}</text>
        </view>
      </block>
      <block wx:else>
        <t-button size="small" theme="primary" bindtap="login">登录</t-button>
      </block>
    </view>
  </view>

  <!-- 横幅滚动区域 -->
  <swiper class="banner-scroll" indicator-dots="{{true}}" autoplay="{{true}}" interval="{{3000}}" duration="{{500}}" circular="{{true}}">
    <swiper-item wx:for="{{banners}}" wx:key="index" bindtap="onBannerTap" data-index="{{index}}" class="banner-item">
      <image src="{{item.image}}" mode="aspectFit" class="banner-image"></image>
    </swiper-item>
  </swiper>

  <!-- 分类选项卡 -->
  <view class="category-tabs">
    <t-tabs
      value="{{activeTab}}"
      bind:change="onTabChange"
      t-class="custom-tabs"
      t-class-active="custom-active-tab"
      t-class-track="custom-track"
    >
      <t-tab-panel wx:for="{{categories}}" wx:key="index" label="{{item}}" value="{{index}}" />
    </t-tabs>
  </view>

  <!-- 商品列表 -->
  <scroll-view 
    scroll-y 
    class="product-list"
    refresher-enabled="{{true}}"
    refresher-triggered="{{refreshing}}"
    bind:refresherpulling="onPulling"
    bind:refresherrefresh="onRefresh"
    bind:scrolltolower="onLoadMore"
  >
    <view class="product-grid">
      <view 
        class="product-card" 
        wx:for="{{productList}}" 
        wx:key="id"
        bind:tap="onProductTap"
        data-id="{{item.id}}"
      >
        <image class="product-image" src="{{item.imgList[0]}}" mode="aspectFill"></image>
        <view class="product-info">
          <view class="product-title">{{item.title}}</view>
          <view class="price-favorite-row">
            <view class="product-price">¥{{item.price}}</view>
            <view class="favorite-icon {{item.isFavorite ? 'active' : ''}}" catch:tap="onFavoriteTap" data-id="{{item.id}}">
              <image src="/assets/icons/{{item.isFavorite ? 'collect_active' : 'collect'}}.png" mode="aspectFit" class="favorite-image"></image>
            </view>
          </view>
        </view>
      </view>
    </view>
    
    <!-- 加载状态 -->
    <view class="loading-state">
      <t-loading wx:if="{{loading}}" theme="circular" size="40rpx" text="加载中..." inherit-color />
      <view wx:if="{{!hasMore && !loading}}" class="no-more">没有更多了~</view>
    </view>
  </scroll-view>
</view> 